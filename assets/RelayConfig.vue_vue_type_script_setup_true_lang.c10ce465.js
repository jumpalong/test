import{ab as L,A as h,L as S,W as m,f as k,aB as M,V as $,o as b,c1 as N,B as C,C as o,D as t,H as x,I as v,F as e,a9 as W,J as E,az as a,bn as j,Q as r,_ as U,a6 as V,c2 as D,aG as P,X as F,c3 as K,c4 as O,aI as G,al as J,a7 as Q,bx as X,ae as q,c5 as Y,c6 as Z,c7 as ee}from"./index.243f7ff1.js";import{_ as z}from"./Tooltip.vue_vue_type_script_setup_true_lang.81fc1d32.js";import{C as te}from"./Close.288a1124.js";import{_ as A}from"./RelayConnectListCard.vue_vue_type_script_setup_true_lang.c6f50d79.js";import{_ as se,a as ne}from"./RelayWritableButton.vue_vue_type_script_setup_true_lang.a00b8f26.js";import{M as ae}from"./MdSearch.45187211.js";const oe={},ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},le=m("path",{d:"M12 22H5a2 2 0 0 1-2-2l.01-14c0-1.1.88-2 1.99-2h1V3c0-.55.45-1 1-1s1 .45 1 1v1h8V3c0-.55.45-1 1-1s1 .45 1 1v1h1c1.1 0 2 .9 2 2v6h-2v-2H5v10h7v2zm10.13-5.01l.71-.71a.996.996 0 0 0 0-1.41l-.71-.71a.996.996 0 0 0-1.41 0l-.71.71l2.12 2.12zm-.71.71l-5.01 5.01c-.18.18-.44.29-.7.29H14.5c-.28 0-.5-.22-.5-.5v-1.21c0-.27.11-.52.29-.71l5.01-5.01l2.12 2.13z",fill:"currentColor"},null,-1),re=[le];function _e(d,c){return h(),S("svg",ce,re)}const ie=L(oe,[["render",_e]]),ue={key:0},de=k({__name:"Broadcast",setup(d){const c=M(),s=$(null);function i(){const n=a.broadcast({slef:j({})});if(!n){c.error(r("message.broadcast_error_message"));return}s.value=n}const l=b(()=>{var n,g,u,f,p,y,B,R;return((g=(n=s.value)==null?void 0:n.numberOfSuccesses)!=null?g:0)+((f=(u=s.value)==null?void 0:u.numberOfErrors)!=null?f:0)+((y=(p=s.value)==null?void 0:p.numberOfOvertime)!=null?y:0)<((R=(B=s.value)==null?void 0:B.total)!=null?R:0)}),_=N();return(n,g)=>{const u=U;return h(),C(z,{tooltip:e(a).hasChange()?e(r)("tips.broadcast_has_change_tip"):e(r)("tips.broadcast_no_change_tip")},{default:o(()=>[t(u,{onClick:i,type:"default",loading:e(l),disabled:e(l)||e(a).hasChange()},{default:o(()=>[x(v(e(l)?e(r)("success_timeout_failure_total"):e(r)("broadcast"))+" ",1),s.value?(h(),S("span",ue,[m("span",{style:W({color:e(_).successColor})},v(s.value.numberOfSuccesses),5),x(" / "),m("span",{style:W({color:e(_).warningColor})},v(s.value.numberOfOvertime),5),x(" / "),m("span",{style:W({color:e(_).errorColor})},v(s.value.numberOfErrors),5),x(" / "),m("span",null,v(s.value.total),1)])):E("",!0)]),_:1},8,["loading","disabled"])]),_:1},8,["tooltip"])}}}),T=k({__name:"ButtonClose",emits:["click"],setup(d,{emit:c}){return(s,i)=>{const l=V,_=U;return h(),C(_,{text:"",circle:"",type:"error",class:"text-[#6c5ce7] hover:text-[#a29bfe]",onClick:i[0]||(i[0]=n=>c("click",n))},{icon:o(()=>[t(l,null,{default:o(()=>[t(te)]),_:1})]),_:1})}}}),pe={key:1},me=k({__name:"RelayConfigurator",setup(d){const c=b(()=>Object.keys(a.getConfiguration()));function s(p){a.hasWriteByUrl(p)?a.remoteWrite(p):a.addWrite(p)}function i(p){a.hasReadByUrl(p)?a.remoteRead(p):a.addRead(p)}const l=$("");function _(){!l.value||a.addWriteRead(l.value)}const n=M();function g(){a.save(),n.success(r("message.relay_configurator_save_message"))}function u(){a.sync(),n.success(r("message.relay_configurator_sync_message"))}const f=b(()=>{const p=a.getUpdateAt();return p||null});return(p,y)=>{const B=ie,R=P,H=U;return h(),C(A,{urls:e(c),title:e(r)("relay_configuration")},{"header-extra":o(()=>[t(e(V),{class:"mr-1"},{default:o(()=>[t(B)]),_:1}),e(f)?(h(),C(D,{key:0,secondTimestamp:e(f)},null,8,["secondTimestamp"])):(h(),S("span",pe,"null"))]),right:o(({url:w})=>[t(se,{active:e(a).hasWriteByUrl(w),class:"mr-1",onSwitch:()=>s(w)},null,8,["active","onSwitch"]),t(ne,{active:e(a).hasReadByUrl(w),class:"mr-2",onSwitch:()=>i(w)},null,8,["active","onSwitch"]),t(T,{text:"",onClick:()=>e(a).remove(w)},null,8,["onClick"])]),action:o(()=>[t(e(F),null,{default:o(()=>[t(R,{value:l.value,"onUpdate:value":y[0]||(y[0]=w=>l.value=w),type:"text",placeholder:"eg: wss://nostr.wine"},null,8,["value"]),t(H,{onClick:_,type:"primary",disabled:!l.value},{default:o(()=>[x(v(e(r)("add")),1)]),_:1},8,["disabled"]),t(z,{tooltip:e(a).hasChange()?e(r)("tips.save_changes"):e(r)("tips.currently_not_modified")},{default:o(()=>[t(H,{onClick:g,type:"primary",disabled:!e(a).hasChange()},{default:o(()=>[x(v(e(r)("save")),1)]),_:1},8,["disabled"])]),_:1},8,["tooltip"]),t(z,{tooltip:e(a).hasChange()?e(r)("tips.relay_configurator_sync_has_change_tip"):e(r)("tips.relay_configurator_sync_no_change_tip")},{default:o(()=>[t(H,{onClick:u,type:"primary",disabled:e(a).hasChange()},{default:o(()=>[x(v(e(r)("sync")),1)]),_:1},8,["disabled"])]),_:1},8,["tooltip"]),t(de)]),_:1})]),_:1},8,["urls","title"])}}}),he={},fe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ve=m("path",{d:"M17 11h3a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-3a2 2 0 0 0-2 2v1H9.01V5a2 2 0 0 0-2-2H4c-1.1 0-2 .9-2 2v4a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2V8h2v7.01c0 1.65 1.34 2.99 2.99 2.99H15v1a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-3a2 2 0 0 0-2 2v1h-1.01c-.54 0-.99-.45-.99-.99V8h2v1c0 1.1.9 2 2 2z",fill:"currentColor"},null,-1),ge=[ve];function ye(d,c){return h(),S("svg",fe,ge)}const I=L(he,[["render",ye]]),xe={class:"flex-shrink-0"},Ce=k({__name:"RelayConnected",setup(d){const c=b(()=>O.getPool()),s=b(()=>[...c.value.keys()]);function i(_){const n=O.getRelayFromPool(_);return n?n.subIds.size:0}function l(_){const n=O.getRelayFromPool(_);return n?n.publishIds.size:0}return(_,n)=>{const g=V;return h(),C(A,{urls:e(s),title:e(r)("active_relay")},{"header-extra":o(()=>[t(g,{class:"mr-1"},{default:o(()=>[t(I)]),_:1}),x(" "+v(e(s).length),1)]),right:o(({url:u})=>[m("span",xe," ("+v(i(u))+","+v(l(u))+") ",1),t(K,{disabled:e(a).hasReadByUrl(u)||e(a).hasWriteByUrl(u),class:"ml-2",onClick:()=>e(a).addWriteRead(u)},null,8,["disabled","onClick"]),t(T,{class:"ml-2",onClick:()=>e(O).close(u),onClose:()=>{var f;return(f=e(c).get(u))==null?void 0:f.close()}},null,8,["onClick","onClose"])]),_:1},8,["urls","title"])}}}),we={},be={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ke=m("path",{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85c-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28c77.418-.07 144.315-53.144 162.787-126.849c1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z",fill:"currentColor"},null,-1),$e=[ke];function Se(d,c){return h(),S("svg",be,$e)}const Ve=L(we,[["render",Se]]);function Be(d,{message:c,dialog:s}){return new Promise((i,l)=>{a.sync({onlyUrl:d,onEvent(_,n){s.success({title:r("success"),content:r("handel_sync_on_event_message",{url:n}),positiveText:r("yes")}),i("pull")},onPush(){c.success(r("handel_sync_on_push_message",{url:d})),i("push")}}),c.info(r("handel_sync_info",{url:d}))})}function Re(d){const c=G(),s=M(),i=$(),l=$("default"),_=N(),n=b(()=>{switch(l.value){case"pull":return _.value.successColor;case"push":return _.value.primaryColor;default:return _.value.textColor1}});return{isLoading:i,status:l,color:n,handelSync:async()=>{i.value=!0,l.value=await Be(e(d),{message:s,dialog:c}),i.value=!1}}}const Oe=k({__name:"SyncButton",props:{url:null},setup(d){const c=d,{handelSync:s,status:i,isLoading:l,color:_}=Re(J(c,"url"));return(n,g)=>{const u=V,f=U;return h(),C(z,{tooltip:e(r)("sync_tooltip")},{default:o(()=>[t(f,{text:"",onClick:e(s),class:Q({turn:e(l)})},{default:o(()=>[t(u,{color:e(_)},{default:o(()=>[t(Ve)]),_:1},8,["color"])]),_:1},8,["onClick","class"])]),_:1},8,["tooltip"])}}});const ze=L(Oe,[["__scopeId","data-v-99831d93"]]),Le={class:"flex items-center justify-center flex-shrink flex-grow"},Ue={class:"flex-shrink-0 flex justify-center items-center"},He={class:"flex-shrink ml-2 flex-grow w-32 sm:w-auto"},We=k({__name:"RelayOther",setup(d){const c=$(""),s=$([]),i=b(()=>a.getOtherList());function l(){if(c.value===""){s.value=Array.from(i.value);return}s.value=Array.from(i.value).filter(n=>n.includes(c.value))}l();const _=X(l,1e3);return q([c,i],_,{deep:!0}),(n,g)=>{const u=V,f=ae,p=P;return h(),C(A,{loadable:"",urls:s.value,title:e(r)("more")},{"header-extra":o(()=>[m("div",Le,[m("div",Ue,[t(u,{class:"mr-1"},{default:o(()=>[t(I)]),_:1}),m("span",null,v(s.value.length),1)]),m("div",He,[t(p,{round:"",placeholder:e(r)("search"),value:c.value,"onUpdate:value":g[0]||(g[0]=y=>c.value=y),onKeyup:Y(l,["enter"]),onChange:l},{suffix:o(()=>[t(u,null,{default:o(()=>[t(f)]),_:1})]),_:1},8,["placeholder","value","onKeyup"])])])]),right:o(({url:y})=>[t(Z,{class:"mr-2",url:y},null,8,["url"]),t(ze,{url:y},null,8,["url"])]),_:1},8,["urls","title"])}}}),Me={class:"mt-2"},Ae={class:"mt-2"},De=k({__name:"RelayConfig",setup(d){return(c,s)=>(h(),C(e(ee),{class:"h-full w-full"},{default:o(()=>[m("div",null,[t(me)]),m("div",Me,[t(Ce)]),m("div",Ae,[t(We)])]),_:1}))}});export{De as _};
