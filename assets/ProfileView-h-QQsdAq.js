import{p as Y}from"./profile-2-400x400-D2vuwnc_.js";import{E as Z}from"./Ellipsis-0EM5UHUc.js";import{_ as ee,C as te,a as oe}from"./Papaw-Deuq0NJ6.js";import{u as ne}from"./metadata-BSJpBFOv.js";import{_ as W,a as ae}from"./FollowItem.vue_vue_type_script_setup_true_lang-CG16H4cC.js";import{f as L,L as S,ao as B,k as d,o as m,B as w,n,w as r,F as z,C as q,q as e,m as h,al as re,W as se,aq as le,y as C,z as M,U as Q,E as g,A as $,_ as ie,r as ue,S as ce,R as pe,a3 as U,V as _e}from"./index-DVMYH3P6.js";import{_ as J}from"./ListItem-Cp5hsImF.js";import{u as me,S as fe}from"./Scrollbar-Ci8GVXLr.js";import{_ as de}from"./PostList.vue_vue_type_script_setup_true_lang-CXRlCGzr.js";import{u as I,Q as T,c as ye,y as G,r as V,A as ve,s as ke,m as F,E as be,B as X,t as ge,p as he,n as we,M as xe,d as $e}from"./ProvideEventLine-BcjESPsS.js";import{a as Ce,b as Le,d as Me,_ as Pe}from"./RelayAddButton.vue_vue_type_script_setup_true_lang-ClC0X4xN.js";import{b as P}from"./Button-Czpa3xjC.js";import{_ as Se,a as Be}from"./Tabs-v5GAMoQb.js";import{_ as Ee}from"./Image-Dkv-cPOO.js";import{_ as A}from"./Space-CvpcAwGw.js";import{N as Ne}from"./Icon-affED87R.js";import{n as R}from"./MavonEditor-U6vvA0Sq.js";import{u as ze,r as D}from"./naiveUi-D97WfHUp.js";import{_ as Ie}from"./UserMetadataEditing.vue_vue_type_script_setup_true_lang-CIcwC-xN.js";import{_ as Re}from"./Tooltip-BuuQH49V.js";import{_ as Ae}from"./Card-mMUmU99e.js";import{_ as Ue}from"./Modal-CQ-j8Rsm.js";import{_ as Ve}from"./Dropdown-DxJRtvYm.js";import"./NaddrLink.vue_vue_type_script_setup_true_lang-CCeX8OoD.js";import"./Markdown-CCAxwuGA.js";import"./utils-BXkRfzfk.js";import"./DateTime.vue_vue_type_script_setup_true_lang-CutDhaEt.js";import"./Spin-D-ja7p5P.js";import"./Scrollbar-BXVF4b7l.js";import"./use-rtl-CqBkFAUg.js";import"./use-css-vars-class-DpRsL9zm.js";import"./index-vZmvdULR.js";import"./use-compitable-CysNw4x-.js";import"./Tag-Cl4r3gCd.js";import"./Close-CMpDg3pB.js";import"./Icon-DjYnwRew.js";import"./Close-Dj7wgTNH.js";import"./replaceable-DvMWTdGr.js";import"./use-theme-vars-Cj3ejyij.js";import"./fade-in-height-expand.cssr-JdnZy7mo.js";import"./ContentBlacklistView-BsctE9vS.js";import"./Input-Bl1B22BO.js";import"./use-locale-CYSJLCZe.js";import"./Empty-CBIm7nuM.js";import"./Divider-Dkdhd_MI.js";import"./utils-ByHrdkP9.js";import"./is-browser-BikuuYFQ.js";import"./ReloadCircleSharp-GyWaURTC.js";import"./Scrollbar-CnPFJxyc.js";import"./PapawList.vue_vue_type_script_setup_true_lang-DhIrlK79.js";import"./RelayInfoView-YGg7axqY.js";import"./Add-B8K751Td.js";import"./render-BaVY8WQh.js";import"./omit-DbnPTcif.js";import"./Follower-R8EgPpAd.js";import"./fade-in-scale-up.cssr-CUPxiz5B.js";import"./download-sglA049O.js";import"./get-slot-Bk_rJcZu.js";import"./format-length-B-p6aW7q.js";import"./DrawerContent-CWwlzEAX.js";import"./Popover-C3ccDlka.js";import"./index-DsSU6HIH.js";import"./hkdf-MGlbgreC.js";import"./Checkbox-5kBy0qes.js";import"./composables-CG8Dm3JP.js";import"./UploadButton.vue_vue_type_script_setup_true_lang-DLAEcrTL.js";import"./Warning-CFOd0oLB.js";import"./keysOf-HiGXOwLp.js";import"./Dialog-D5oKNXJ_.js";import"./create-DlBt9mlr.js";const Fe=L({__name:"Follow",props:{pubkey:{},urls:{},active:{type:Boolean}},setup(y){const _=S(!1),u=y,{pubkey:i,urls:o,active:p}=B(u),a=d(()=>(_.value=!_.value,contactApi.getContactListLineByPubkey(i.value,{urls:o==null?void 0:o.value}))),s=usePubkey(),k=d(()=>s.value?i.value===s.value?Object.values(contactConfiguration.getContactConfiguration()):a.value.feat.getContactList():[]),c=S(void 0);return useElementIntoScreen(c,{active:p}),(l,b)=>(m(),w("div",{ref_key:"divRef",ref:c,class:"p-4 box-border"},[n(e(J),null,{default:r(()=>[(m(!0),w(z,null,q(e(k),f=>(m(),h(W,{key:f.pubkey,contact:f,pubkey:f.pubkey,name:f.name},null,8,["contact","pubkey","name"]))),128))]),_:1})],512))}}),He=L({__name:"Follower",props:{pubkey:{},active:{type:Boolean},urls:{}},setup(y){const _=y,{pubkey:u,active:i}=B(_),o=d(()=>contactApi.getFollowerLineByPubkey(u.value)),p=d(()=>o.value.getList());me(o,i);const a=S(void 0);return useElementIntoScreen(a,{active:re(_,"active")}),(s,k)=>(m(),w("div",{ref_key:"divRef",ref:a,class:"p-4 box-border"},[n(e(J),null,{default:r(()=>[(m(!0),w(z,null,q(e(p),c=>(m(),h(W,{key:c.pubkey,pubkey:c.pubkey},null,8,["pubkey"]))),128))]),_:1})],512))}}),Ke=L({__name:"ProfileMoreInfoRelayList",props:{pubkey:{},active:{type:Boolean}},setup(y){const _=y,u=se(),{pubkey:i}=B(_),o=I(G,ye,T.Staff),p=d(()=>o.getUserRelayUrlConfigByPubkey(i.value)),a=le(async()=>{var l;return i.value===((l=await o.getPubkeyOrNull())==null?void 0:l.toHex())?o.relayConfigurator.getConfiguration():p.value.getRelayConfiguration()}),s=d(()=>a.value&&Object.keys(a.value.config));function k(){u.push({name:"relays"})}return(c,l)=>{const b=P,f=ee;return m(),w(z,null,[n(f,{show:e(o).relayConfigurator.hasChange()},{default:r(()=>[n(b,{onClick:k,type:"primary"},{default:r(()=>[C(M(c.t("save")),1)]),_:1})]),_:1},8,["show"]),n(Pe,{urls:e(s)??[],title:""},{right:r(({url:v})=>{var x,E;return[n(Ce,{active:((x=e(a))==null?void 0:x.write.has(v))??!1,class:"mr-1"},null,8,["active"]),n(Le,{active:((E=e(a))==null?void 0:E.read.has(v))??!1,class:"mr-2"},null,8,["active"]),n(Me,{url:v},null,8,["url"])]}),_:1},8,["urls"])],64)}}}),Oe=L({__name:"ProfileMoreInfo",props:{pubkey:{},urls:{}},setup(y){const _=y,{pubkey:u}=B(_),i=d(()=>[u.value]),o=S("homepage");return V(),(p,a)=>{const s=Se,k=Be;return m(),h(k,{type:"line",value:e(o),"onUpdate:value":a[0]||(a[0]=c=>Q(o)?o.value=c:null),animated:""},{default:r(()=>[n(s,{"display-directive":"show:lazy",name:"homepage",tab:p.t("homepage")},{default:r(()=>[n(de,{active:e(o)==="homepage",filters:[{kinds:[1,30023],authors:e(i),limit:5}],urls:_.urls},null,8,["active","filters","urls"])]),_:1},8,["tab"]),n(s,{"display-directive":"show:lazy",name:"follow",tab:p.t("follow")},{default:r(()=>[n(Fe,{active:e(o)==="follow",pubkey:e(u),urls:p.urls},null,8,["active","pubkey","urls"])]),_:1},8,["tab"]),n(s,{"display-directive":"show:lazy",name:"follower",tab:p.t("follower")},{default:r(()=>[n(He,{active:e(o)==="follower",pubkey:e(u)},null,8,["active","pubkey"])]),_:1},8,["tab"]),n(s,{"display-directive":"show:lazy",name:"中继",tab:p.t("relay")},{default:r(()=>[n(Ke,{active:e(o)==="relay",pubkey:e(u)},null,8,["active","pubkey"])]),_:1},8,["tab"])]),_:1},8,["value"])}}}),je={key:0,class:"w-full h-full flex flex-col"},De={class:"flex flex-col"},We={class:"flex items-center justify-end px-8 mt-4"},qe={class:"flex items-center"},Qe={class:"ml-1"},Je={class:"w-full",style:{"word-break":"break-all","text-overflow":"ellipsis","word-wrap":"break-word"}},Te=L({__name:"Profile",props:{pubkey:{},urls:{}},setup(y){let _=y,{pubkey:u,urls:i}=B(_);const o=ne(u),[p]=ve(.3);return(a,s)=>{const k=Ee,c=ae,l=A,b=Ne,f=P;return e(u)?(m(),w("div",je,[n(fe,{class:"flex-shrink flex-1 h-0",refreshable:"",loadable:""},{default:r(()=>{var v,x,E,H,K,O,j;return[g("div",De,[g("div",{ref_key:"target",ref:p,class:"h-0 w-full relative flex-shrink-0",style:{}},[((v=e(o))==null?void 0:v.banner)??((x=e(o))==null?void 0:x.picture)?(m(),h(k,{key:0,src:((E=e(o))==null?void 0:E.banner)??((H=e(o))==null?void 0:H.picture),"object-fit":"cover",class:"w-full h-full banner"},null,8,["src"])):$("",!0),n(c,{class:"absolute bottom-0 left-2",style:ie({transform:"translate(0,50%)"}),round:"",size:100,src:((K=e(o))==null?void 0:K.picture)??e(Y)},null,8,["style","src"])],512),g("div",null,[g("div",We,[n(l,null,{default:r(()=>[ue(a.$slots,"right")]),_:3})]),g("h1",qe,[n(Z,null,{default:r(()=>{var N;return[C(M(((N=e(o))==null?void 0:N.name)??e(u).slice(0,10)),1)]}),_:1})]),(O=e(o))!=null&&O.lud16?(m(),h(f,{key:0,text:"",class:"flex items-center mb-2"},{default:r(()=>{var N;return[n(b,null,{default:r(()=>[n(te)]),_:1}),g("span",Qe,M((N=e(o))==null?void 0:N.lud16),1)]}),_:1})):$("",!0),g("div",Je,M((j=e(o))==null?void 0:j.about),1)])]),e(u)?(m(),h(Oe,{key:0,pubkey:e(u).toHex(),urls:e(i)},null,8,["pubkey","urls"])):$("",!0)]}),_:3})])):$("",!0)}}}),Ge=L({__name:"UserDataEditing",emits:["close"],setup(y,{emit:_}){ce();const u=_;let i=I(G,F);const o=S({}),p=V(),a=d(()=>{if(p.value)return i.getUserMetadataLineByPubkey(p.value)}),s=d(()=>a.value&&a.value.feat.getMetadata());pe(()=>{s.value&&(o.value=s.value)});let k=ke();const c=S(!1);async function l(){var f,v;c.value=!0;let b=i==null?void 0:i.add(be);b.addPublish(await i.createEvent({content:JSON.stringify(o.value),kind:0,tags:((v=(f=a.value)==null?void 0:f.getLatestEvent())==null?void 0:v.tags)??[]}),{onOK:k}),b.initedAddWrite()}return(b,f)=>{const v=Re,x=Ae;return e(a)?(m(),h(x,{key:0,class:"w-[600px] max-w-full max-h-full",title:"编辑用户信息",bordered:!1,role:"dialog","aria-modal":"true"},{default:r(()=>[n(e(A),{vertical:""},{default:r(()=>[n(Ie,{userMetadata:e(o)},null,8,["userMetadata"]),n(e(A),{center:""},{default:r(()=>[n(e(P),{type:"tertiary",onClick:f[0]||(f[0]=()=>u("close"))},{default:r(()=>[C(M(b.t("cancel")),1)]),_:1}),n(v,{trigger:"hover"},{trigger:r(()=>[n(e(P),{type:"primary",onClick:l,loading:e(c),disabled:e(c)},{default:r(()=>[C(M(b.t("submit")),1)]),_:1},8,["loading","disabled"])]),default:r(()=>[C(" 如果加载不到合适的信息，那可能是relays设置不对请尝试配置一下 ")]),_:1}),e(c)?(m(),h(v,{key:0,trigger:"hover"},{trigger:r(()=>[n(e(P),{onClick:f[1]||(f[1]=()=>c.value=!1)},{default:r(()=>[C("停止加载")]),_:1})]),default:r(()=>[C(" 如果您是新用户的话，或者您放弃之前的信息就可以点此处 ")]),_:1})):$("",!0)]),_:1})]),_:1})]),_:1})):$("",!0)}}}),Xe={},Ye={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ze=g("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44",d:"M358.62 129.28L86.49 402.08L70 442l39.92-16.49l272.8-272.13l-24.1-24.1z"},null,-1),et=g("path",{d:"M413.07 74.84l-11.79 11.78l24.1 24.1l11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"44"},null,-1),tt=[Ze,et];function ot(y,_){return m(),w("svg",Ye,tt)}const nt=U(Xe,[["render",ot]]),at={},rt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},st=g("path",{d:"M384 336a63.78 63.78 0 0 0-46.12 19.7l-148-83.27a63.85 63.85 0 0 0 0-32.86l148-83.27a63.8 63.8 0 1 0-15.73-27.87l-148 83.27a64 64 0 1 0 0 88.6l148 83.27A64 64 0 1 0 384 336z",fill:"currentColor"},null,-1),lt=[st];function it(y,_){return m(),w("svg",rt,lt)}const ut=U(at,[["render",it]]),ct=L({__name:"UserInformationButton",props:{pubkey:{}},setup(y){const _=y,{pubkey:u}=B(_),i=I(F),o=ze(),p=X(u),a=S(!1),s=d(()=>u.value.toHex());console.log("isItMe",p.value,"pubkey",u.value);const k=d(()=>{var c;return[p.value&&{label:t("edit_user_profile"),key:"editProfile",icon:D(nt),props:{onclick(){a.value=!a.value}}},{label:t("copy"),key:"clipboard",icon:D(ut),children:[{label:`${t("copy")} npub`,key:"copy-npub",props:{onclick(){const l=R.npubEncode(s.value);o(l)}}},{label:`${t("copy")} nprofile`,key:"copy-npro",props:{onclick(){const l=R.nprofileEncode({pubkey:s.value,relays:[...i.relayConfigurator.getWriteList()]});o(l)}}},p.value&&i.getNostrApiMode()===ge.PrivateKey&&((c=i.getNostrApi())==null?void 0:c.getPrivateKey)&&typeof i.getNostrApi().getPrivateKey=="function"&&{label:`${t("copy")} nsec`,key:"copy-nsec",props:{onclick(){const l=R.nsecEncode(i.getNostrApi().getPrivateKey());o(l)}}},{label:`${t("copy")} publicKey hex`,key:"copy-hex",props:{onclick(){o(s.value)}}}].filter(l=>!!l)},{label:t("recommend_user"),key:"recommendUser",props:{onclick(){}}},{label:t("recommend_metadata"),key:"recommendUserMetadata",props:{onclick(){}}}].filter(l=>!!l)});return(c,l)=>{const b=P,f=Ve,v=Ue;return m(),w(z,null,[n(f,{placement:"bottom-start",trigger:"click",options:e(k)},{default:r(()=>[n(b,{circle:"",type:"info"},{default:r(()=>[n(oe)]),_:1})]),_:1},8,["options"]),n(v,{show:e(a),"onUpdate:show":l[1]||(l[1]=x=>Q(a)?a.value=x:null)},{default:r(()=>[n(Ge,{onClose:l[0]||(l[0]=()=>a.value=!1)})]),_:1},8,["show"])],64)}}}),pt={key:1},_t=L({__name:"ProfileView",setup(y){const _=_e(),u=V(),i=I(T.Staff,he.ListSynchronizerManager.Staff,F),o=d(()=>i.listSynchronizerManager.getInitStandardListSynchronizer(we.Follow)),p=d(()=>_.params.value),a=d(()=>p.value&&xe(p.value)),s=d(()=>a.value?$e.fromHex(a.value.pubkey):u.value),k=X(s),c=d(()=>a.value?new Set(a.value.relays):i.relayConfigurator.getWriteList()),l=d(()=>s.value?o.value.has({type:"p",pubkey:s.value.toHex()}):!1);async function b(){s.value&&(l.value?await o.value.delete({type:"p",pubkey:s.value.toHex()}):await o.value.add({type:"p",pubkey:s.value.toHex()}))}return(f,v)=>s.value?(m(),h(Te,{key:0,pubkey:s.value,urls:c.value},{right:r(()=>[e(k)?$("",!0):(m(),h(e(P),{key:0,class:"ml-4",strong:"",round:"",type:l.value?"warning":"primary",onClick:b},{default:r(()=>[C(M(l.value?"UnFollow":"Follow"),1)]),_:1},8,["type"])),s.value?(m(),w("div",pt,[n(ct,{pubkey:s.value},null,8,["pubkey"])])):$("",!0)]),_:1},8,["pubkey","urls"])):$("",!0)}}),Bo=U(_t,[["__scopeId","data-v-6d782f41"]]);export{Bo as default};
