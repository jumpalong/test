function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{b as Ie,c as ue,f as X,u as ze,g as pe,bj as je,L as M,k as Z,N as Fe,h as A,T as Oe,P as Ue,ag as oe,bk as Pe,R as Ae,ah as he,ao as ae,o as B,B as L,n as _,w as C,y as Q,z as G,q as y,m as j,F as me,C as ve,E as R,A as Le,U as _e,au as He,H as ge,aV as Ne,ax as De,aU as We,a5 as Ke,a3 as le,bl as qe,an as Xe,bm as Ye,_ as ce,bf as te,bg as ne,Z as Je,aK as Ze}from"./index-DVMYH3P6.js";import{ac as Ge,u as xe,ad as Qe,a2 as et,ab as tt,a9 as de,ae as nt,af as ot}from"./ProvideEventLine-BcjESPsS.js";import{_ as we,u as ie,e as st,f as at,g as lt,h as it}from"./Papaw-Deuq0NJ6.js";import{d as rt}from"./utils-BXkRfzfk.js";import{N as ye}from"./Divider-Dkdhd_MI.js";import{_ as be}from"./Spin-D-ja7p5P.js";import{_ as ut}from"./Tooltip-BuuQH49V.js";import{u as ct,e as dt,c as J,b as Se}from"./Button-Czpa3xjC.js";import{_ as ke}from"./Space-CvpcAwGw.js";import{S as Ce}from"./Scrollbar-Ci8GVXLr.js";import{_ as ft}from"./Result-BxKSbHjS.js";import{_ as Te}from"./Input-Bl1B22BO.js";import{_ as pt}from"./Card-mMUmU99e.js";import{_ as ht,a as mt}from"./Tabs-v5GAMoQb.js";import{i as vt}from"./is-browser-BikuuYFQ.js";import{f as _t}from"./fade-in-scale-up.cssr-CUPxiz5B.js";import{c as gt}from"./create-DlBt9mlr.js";import{a as xt}from"./Scrollbar-BXVF4b7l.js";import{u as wt}from"./use-css-vars-class-DpRsL9zm.js";import{N as yt}from"./SelectMenu-P-o4iW_T.js";import{u as se,V as bt,a as St,b as kt}from"./Follower-R8EgPpAd.js";import{u as Ct,_ as Tt}from"./UploadButton.vue_vue_type_script_setup_true_lang-DLAEcrTL.js";import{C as Et}from"./Close-DB389nBU.js";import{N as Mt}from"./Icon-affED87R.js";function $t(e,u={debug:!1,useSelectionEnd:!1,checkWidthOverflow:!0}){const r=e.selectionStart!==null?e.selectionStart:0,f=e.selectionEnd!==null?e.selectionEnd:0,p=u.useSelectionEnd?f:r,i=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],a=navigator.userAgent.toLowerCase().includes("firefox");if(!vt)throw new Error("textarea-caret-position#getCaretPosition should only be called in a browser");const l=u==null?void 0:u.debug;if(l){const b=document.querySelector("#input-textarea-caret-position-mirror-div");b!=null&&b.parentNode&&b.parentNode.removeChild(b)}const s=document.createElement("div");s.id="input-textarea-caret-position-mirror-div",document.body.appendChild(s);const t=s.style,n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,c=e.nodeName==="INPUT";t.whiteSpace=c?"nowrap":"pre-wrap",c||(t.wordWrap="break-word"),t.position="absolute",l||(t.visibility="hidden"),i.forEach(b=>{if(c&&b==="lineHeight")if(n.boxSizing==="border-box"){const S=parseInt(n.height),E=parseInt(n.paddingTop)+parseInt(n.paddingBottom)+parseInt(n.borderTopWidth)+parseInt(n.borderBottomWidth),x=E+parseInt(n.lineHeight);S>x?t.lineHeight=`${S-E}px`:S===x?t.lineHeight=n.lineHeight:t.lineHeight="0"}else t.lineHeight=n.height;else t[b]=n[b]}),a?e.scrollHeight>parseInt(n.height)&&(t.overflowY="scroll"):t.overflow="hidden",s.textContent=e.value.substring(0,p),c&&s.textContent&&(s.textContent=s.textContent.replace(/\s/g,"Â "));const h=document.createElement("span");h.textContent=e.value.substring(p)||".",h.style.position="relative",h.style.left=`${-e.scrollLeft}px`,h.style.top=`${-e.scrollTop}px`,s.appendChild(h);const v={top:h.offsetTop+parseInt(n.borderTopWidth),left:h.offsetLeft+parseInt(n.borderLeftWidth),absolute:!1,height:parseInt(n.fontSize)*1.5};return l?h.style.backgroundColor="#aaa":document.body.removeChild(s),v.left>=e.clientWidth&&u.checkWidthOverflow&&(v.left=e.clientWidth),v}const Bt=Ie([ue("mention","width: 100%; z-index: auto; position: relative;"),ue("mention-menu",`
 box-shadow: var(--n-menu-box-shadow);
 `,[_t({originalTransition:"background-color .3s var(--n-bezier), box-shadow .3s var(--n-bezier)"})])]),Rt=Object.assign(Object.assign({},pe.props),{to:se.propTo,autosize:[Boolean,Object],options:{type:Array,default:[]},type:{type:String,default:"text"},separator:{type:String,validator:e=>e.length!==1?(Ue("mention","`separator`'s length must be 1."),!1):!0,default:" "},bordered:{type:Boolean,default:void 0},disabled:Boolean,value:String,defaultValue:{type:String,default:""},loading:Boolean,prefix:{type:[String,Array],default:"@"},placeholder:{type:String,default:""},placement:{type:String,default:"bottom-start"},size:String,renderLabel:Function,status:String,"onUpdate:show":[Array,Function],onUpdateShow:[Array,Function],"onUpdate:value":[Array,Function],onUpdateValue:[Array,Function],onSearch:Function,onSelect:Function,onFocus:Function,onBlur:Function,internalDebug:Boolean}),Vt=X({name:"Mention",props:Rt,setup(e){const{namespaceRef:u,mergedClsPrefixRef:r,mergedBorderedRef:f,inlineThemeDisabled:p}=ze(e),i=pe("Mention","-mention",Bt,je,e,r),a=ct(e),l=M(null),s=M(null),t=M(null),n=M("");let c=null,h=null,v=null;const b=Z(()=>{const{value:o}=n;return e.options.filter(d=>o?typeof d.label=="string"?d.label.startsWith(o):typeof d.value=="string"?d.value.startsWith(o):!1:!0)}),S=Z(()=>gt(b.value,{getKey:o=>o.value})),E=M(null),x=M(!1),I=M(e.defaultValue),H=Fe(e,"value"),$=xt(H,I),N=Z(()=>{const{self:{menuBoxShadow:o}}=i.value;return{"--n-menu-box-shadow":o}}),w=p?wt("mention",void 0,N,e):void 0;function m(o){if(e.disabled)return;const{onUpdateShow:d,"onUpdate:show":g}=e;d&&J(d,o),g&&J(g,o),o||(c=null,h=null,v=null),x.value=o}function T(o){const{onUpdateValue:d,"onUpdate:value":g}=e,{nTriggerFormChange:V,nTriggerFormInput:F}=a;g&&J(g,o),d&&J(d,o),F(),V(),I.value=o}function k(){return e.type==="text"?l.value.inputElRef:l.value.textareaElRef}function U(){var o;const d=k();if(document.activeElement!==d){m(!1);return}const{selectionEnd:g}=d;if(g===null){m(!1);return}const V=d.value,{separator:F}=e,{prefix:D}=e,Y=typeof D=="string"?[D]:D;for(let P=g-1;P>=0;--P){const O=V[P];if(O===F||O===`
`||O==="\r"){m(!1);return}if(Y.includes(O)){const q=V.slice(P+1,g);m(!0),(o=e.onSearch)===null||o===void 0||o.call(e,q,O),n.value=q,c=O,h=P+1,v=g;return}}m(!1)}function z(){const{value:o}=s;if(!o)return;const d=k(),g=$t(d);g.left+=d.parentElement.offsetLeft,o.style.left=`${g.left}px`,o.style.top=`${g.top+g.height}px`}function ee(){var o;x.value&&((o=t.value)===null||o===void 0||o.syncPosition())}function W(o){T(o),K()}function K(){setTimeout(()=>{z(),U(),oe().then(ee)},0)}function Ee(o){var d,g;if(o.key==="ArrowLeft"||o.key==="ArrowRight"){if(!((d=l.value)===null||d===void 0)&&d.isCompositing)return;K()}else if(o.key==="ArrowUp"||o.key==="ArrowDown"||o.key==="Enter"){if(!((g=l.value)===null||g===void 0)&&g.isCompositing)return;const{value:V}=E;if(x.value){if(V)if(o.preventDefault(),o.key==="ArrowUp")V.prev();else if(o.key==="ArrowDown")V.next();else{const F=V.getPendingTmNode();F?re(F):m(!1)}}else K()}}function Me(o){const{onFocus:d}=e;d==null||d(o);const{nTriggerFormFocus:g}=a;g(),K()}function $e(){var o;(o=l.value)===null||o===void 0||o.focus()}function Be(){var o;(o=l.value)===null||o===void 0||o.blur()}function Re(o){const{onBlur:d}=e;d==null||d(o);const{nTriggerFormBlur:g}=a;g(),m(!1)}function re(o){var d;if(c===null||h===null||v===null)return;const{rawNode:{value:g=""}}=o,V=k(),F=V.value,{separator:D}=e,Y=F.slice(v),P=Y.startsWith(D),O=`${g}${P?"":D}`;T(F.slice(0,h)+O+Y),(d=e.onSelect)===null||d===void 0||d.call(e,o.rawNode,c);const q=h+O.length+(P?1:0);oe().then(()=>{V.selectionStart=q,V.selectionEnd=q,U()})}function Ve(){e.disabled||K()}return{namespace:u,mergedClsPrefix:r,mergedBordered:f,mergedSize:a.mergedSizeRef,mergedStatus:a.mergedStatusRef,mergedTheme:i,treeMate:S,selectMenuInstRef:E,inputInstRef:l,cursorRef:s,followerRef:t,showMenu:x,adjustedTo:se(e),isMounted:dt(),mergedValue:$,handleInputFocus:Me,handleInputBlur:Re,handleInputUpdateValue:W,handleInputKeyDown:Ee,handleSelect:re,handleInputMouseDown:Ve,focus:$e,blur:Be,cssVars:p?void 0:N,themeClass:w==null?void 0:w.themeClass,onRender:w==null?void 0:w.onRender}},render(){const{mergedTheme:e,mergedClsPrefix:u,$slots:r}=this;return A("div",{class:`${u}-mention`},A(Te,{status:this.mergedStatus,themeOverrides:e.peerOverrides.Input,theme:e.peers.Input,size:this.mergedSize,autosize:this.autosize,type:this.type,ref:"inputInstRef",placeholder:this.placeholder,onMousedown:this.handleInputMouseDown,onUpdateValue:this.handleInputUpdateValue,onKeydown:this.handleInputKeyDown,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur,bordered:this.mergedBordered,disabled:this.disabled,value:this.mergedValue}),A(bt,null,{default:()=>[A(St,null,{default:()=>A("div",{style:{position:"absolute",width:0,height:0},ref:"cursorRef"})}),A(kt,{ref:"followerRef",placement:this.placement,show:this.showMenu,containerClass:this.namespace,to:this.adjustedTo,teleportDisabled:this.adjustedTo===se.tdkey},{default:()=>A(Oe,{name:"fade-in-scale-up-transition",appear:this.isMounted},{default:()=>{const{mergedTheme:f,onRender:p}=this;return p==null||p(),this.showMenu?A(yt,{clsPrefix:u,theme:f.peers.InternalSelectMenu,themeOverrides:f.peerOverrides.InternalSelectMenu,autoPending:!0,ref:"selectMenuInstRef",class:[`${u}-mention-menu`,this.themeClass],loading:this.loading,treeMate:this.treeMate,virtualScroll:!1,style:this.cssVars,onToggle:this.handleSelect,renderLabel:this.renderLabel},r):null}})})]}))}});function It(){const e=M(null),u=Pe(()=>import("./emoji-BingUqXn.js"),__vite__mapDeps([]),import.meta.url),r=M(!0);return u.then(f=>{r.value=!1,e.value=f.default}),{data:e,isLoading:r}}function zt(e,u){const r=M({}),f=rt((...i)=>{r.value=p(...i)},500);Ae(()=>{f(u.value,e.value)});function p(i,a){if(!a)return{};const l=he({});for(const s of a){const t=s[0],n=s[1],c=s[2],h=s[3];if(!c.includes(i))continue;let v=l[t];v||(v=[],l[t]=v),v.push({type:t,emoji:n,name:c,UNICODE:h})}return l}return{emojiClassificationTable:r}}const jt={class:"text-xl"},Ft=X({__name:"EmojiBoxItem",props:{type:{},emojiList:{}},emits:["click"],setup(e,{emit:u}){const r=e,{type:f,emojiList:p}=ae(r),[i,a]=Ge(10),l=u;return(s,t)=>{const n=ye,c=be,h=ut,v=Se,b=ke;return B(),L("div",{ref_key:"target",ref:i,class:"target"},[_(n,null,{default:C(()=>[Q(G(y(f)),1)]),_:1}),y(a)?(B(),j(b,{key:1},{default:C(()=>[(B(!0),L(me,null,ve(y(p),(S,E)=>(B(),j(v,{quaternary:"",onClick:()=>l("click",S.emoji),"data-type":y(f),"data-index":E,"data-emoji":S.emoji},{default:C(()=>[_(h,{trigger:"hover"},{trigger:C(()=>[R("span",jt,G(S.emoji),1)]),default:C(()=>[Q(" "+G(S.name),1)]),_:2},1024)]),_:2},1032,["onClick","data-type","data-index","data-emoji"]))),256))]),_:1})):(B(),j(c,{key:0,class:"w-full h-52"}))],512)}}}),Ot={class:"flex flex-col w-full h-96 max-h-full overflow-hidden relative"},Ut={class:"py-4 flex-shrink-0"},Pt={key:1,class:"flex-shrink flex-1 w-full h-0 flex justify-center items-center"},At=X({__name:"EmojiBox",props:{show:{type:Boolean}},emits:["click"],setup(e,{emit:u}){const r=e,{show:f}=ae(r),p=u,i=M(""),{data:a,isLoading:l}=It(),{emojiClassificationTable:s}=zt(a,i),t=Z(()=>Object.keys(s.value));function n(c){p("click",c)}return(c,h)=>{const v=be,b=Te,S=ft,E=pt,x=ht,I=mt,H=we;return B(),j(H,{show:y(f)},{default:C(()=>[R("div",Ot,[_(I,{"default-value":"Emoji",class:"flex w-full h-full"},{default:C(()=>[_(x,{class:"flex-shrink flex-1 h-0 flex flex-col",name:"Emoji",tab:"Emoji"},{default:C(()=>[y(l)?(B(),j(v,{key:0,class:"w-full h-full"})):Le("",!0),R("div",Ut,[_(b,{class:"flex-shrink-0",size:"large",round:"",placeholder:"Search",value:y(i),"onUpdate:value":h[0]||(h[0]=$=>_e(i)?i.value=$:null)},null,8,["value"])]),y(t).length===0?(B(),L("div",Pt,[_(S,{status:"418",title:"ä»€ä¹ˆéƒ½æ²¡æ‰¾åˆ°",description:"è¿™æ˜¯ä¸€ä¸ªæ‚²å‰§"})])):(B(),j(E,{key:2,class:"flex-shrink flex-1 w-full h-0 flex",contentStyle:{height:"100%",width:"100%"}},{default:C(()=>[_(Ce,{class:"w-full h-full"},{default:C(()=>[(B(!0),L(me,null,ve(y(t),$=>(B(),j(Ft,{onClick:n,key:$,type:$,emojiList:y(s)[$]},null,8,["type","emojiList"]))),128))]),_:1})]),_:1}))]),_:1})]),_:1})])]),_:1},8,["show"])}}});function Lt(){var p;const e=xe(Qe),u=new Map,r=he([]),f=e.getInitReplaceableEventMap(0).allMap();for(const i in f){const a=f[i],l=et(a),s=l.displayName??l.name??((p=a.pubkey)==null?void 0:p.slice(8)),t=encodeURI(s);u.set(t,{event:a,metadata:l}),r.push({label:s,value:t,key:a.pubkey})}return{userRefMentionOption:r,userMap:u}}function Ht(e){const u=new Map,r=M([]),f=[];function p(t){const{content:n,id:c}=t;f.push({label:n.slice(0,20),value:`${s(t)}`,key:c})}function i(t,n){u.set(s(t),{event:t,marker:n}),p(t)}function a(t){r.value=[],r.value.push(["e",t.id]),r.value.push(["p",t.pubkey]),r.value.push(tt(t.tags)??["e",t.id,"","root"]),r.value.push(...t.tags.filter(n=>n[0]==="e"&&n[1]&&(!n[3]||n[3]==="reply")).map(n=>[n[0],n[1],n[2]??"","mention"])),r.value.push(...t.tags.filter(n=>n[0]==="p"&&n[1]).map(n=>n.map(c=>c??""))),r.value.push(...t.tags.filter(n=>n[0]==="r"&&n[1]).map(n=>n.map(c=>c??"")))}function l(t){e.value===""?e.value+=`&${s(t)}
`:e.value+=`
&${s(t)}
`,i(t,"mention")}function s(t){return`${t.id}`}return{eventMap:u,eventMentionOption:f,replyEvent:a,relaysTags:r,addEvent:i,mentionEvent:l}}function Nt(e,u,r){function f(p){const i={userMap:{},eventMap:{},value:p,tags:[],replyTags:r.value},{tags:a}=i,l=p.replace(/@\S+|(\s|^)#\S+|&\S+/g,s=>{const t=s[0];let n=s.slice(1);switch(t){case"@":const c=e.get(n);if(!c)return s;i.userMap[n]=c;const h=de(c.event.tags);return a.push(["p",c.event.pubkey,[...h][0]]),`#[${a.length-1}]`;case`
`:case" ":n=n.slice(1);case"#":return a.push(["t",n]),`#[${a.length-1}]`;case"&":const v=u.get(n);if(!v)return s;i.eventMap[n]=v;const b=v.event,S=[...de(v.event.tags)];S.forEach(x=>a.push(["r",x])),a.push(["e",v.event.id,[...S][0]??"",v.marker]);const E=a.length-1;return a.push(["p",v.event.pubkey,[...S][0]??"","mention"]),a.push(...b.tags.filter(x=>x[0]==="e").map(x=>["e",x[1],x[2],"mention"])),a.push(...b.tags.filter(x=>x[0]==="p")),`#[${E}]`;default:return s}});return a.push(...i.replyTags),[l,a,i]}return f}const fe={...He,duration:1e3*60*60};function Dt(e,u,r,f){const p="rich-text-source-options",i=ie();ge(()=>i.id,()=>{try{const t=Ne(l(),fe);for(const[n,c]of Object.entries(t.userMap))y(e).set(n,c);for(const[n,c]of Object.entries(t.eventMap))y(u).set(n,c);r.value=t.value,f.value=t.replyTags}catch{}},{immediate:!0});function a(t){De(l(),t,fe)}function l(){return`${p}:${i.id}`}function s(){We(l())}return{changeSourceCache:a,clearCache:s}}const Wt=X({__name:"RichTextEditBoxInput",props:{rawValue:{}},emits:["change","blur","focus","update:rawValue"],setup(e,{emit:u}){const r=e,{rawValue:f}=ae(r);let p="";const i=ie(),a=u,l=nt(r,"rawValue"),{userRefMentionOption:s,userMap:t}=Lt(),{eventMap:n,eventMentionOption:c,addEvent:h,replyEvent:v,mentionEvent:b,relaysTags:S}=Ht(l),E=Nt(t,n,S);ge(f,async()=>{await oe(),N()},{immediate:!0}),i.onRichTextEditBox("reply",T=>{v(T),w()}),i.onRichTextEditBox("mention",T=>{b(T),w()}),i.onRichTextEditBox("clear",m);const x=M([]);function I(T,k){k==="@"?x.value=s:k==="&"&&(x.value=c)}const{changeSourceCache:H,clearCache:$}=Dt(t,n,l,S);function N(){const T=l.value;p!==T&&(p=T,w())}function w(){const T=l.value,[k,U,z]=E(T);H(z),a("change",k,{tags:U,sourceOptions:z})}function m(){$(),S.value=[],l.value="",w()}return(T,k)=>{const U=Vt;return B(),j(U,{type:"textarea",autosize:"",class:"w-full",onBlur:k[0]||(k[0]=()=>T.$emit("blur")),onFocus:k[1]||(k[1]=()=>T.$emit("focus")),placeholder:y(Ke)("rich_text_edit_box_input_placeholder"),onChange:N,"show-count":"",maxlength:3e3,value:y(l),"onUpdate:value":k[2]||(k[2]=z=>_e(l)?l.value=z:null),options:y(x),prefix:["@","&"],onSearch:I},null,8,["placeholder","value","options"])}}}),Kt={},qt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Xt=R("g",{fill:"none"},[R("path",{d:"M10.53 1.72a.75.75 0 0 0-1.06 0l-4 4a.75.75 0 0 0 1.06 1.06l2.72-2.72v10.19a.75.75 0 0 0 1.5 0V4.06l2.72 2.72a.75.75 0 1 0 1.06-1.06l-4-4zM4.5 16.5a.75.75 0 0 0 0 1.5h11a.75.75 0 0 0 0-1.5h-11z",fill:"currentColor"})],-1),Yt=[Xt];function Jt(e,u){return B(),L("svg",qt,Yt)}const Zt=le(Kt,[["render",Jt]]),Gt={},Qt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},en=R("g",{fill:"none"},[R("path",{d:"M12.007 6.81l-5.949 5.95c-.319.318-.719.545-1.156.654l-2.283.57a.498.498 0 0 1-.604-.603l.57-2.283a2.49 2.49 0 0 1 .656-1.156l5.948-5.95l2.818 2.817zm1.41-4.226c.777.778.777 2.039 0 2.817l-.706.704l-2.817-2.818l.705-.703a1.992 1.992 0 0 1 2.817 0z",fill:"currentColor"})],-1),tn=[en];function nn(e,u){return B(),L("svg",Qt,tn)}const on=le(Gt,[["render",nn]]),sn={},an={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},ln=R("path",{d:"M928 161H699.2c-49.1 0-97.1 14.1-138.4 40.7L512 233l-48.8-31.3A255.2 255.2 0 0 0 324.8 161H96c-17.7 0-32 14.3-32 32v568c0 17.7 14.3 32 32 32h228.8c49.1 0 97.1 14.1 138.4 40.7l44.4 28.6c1.3.8 2.8 1.3 4.3 1.3s3-.4 4.3-1.3l44.4-28.6C602 807.1 650.1 793 699.2 793H928c17.7 0 32-14.3 32-32V193c0-17.7-14.3-32-32-32zM404 553.5c0 4.1-3.2 7.5-7.1 7.5H211.1c-3.9 0-7.1-3.4-7.1-7.5v-45c0-4.1 3.2-7.5 7.1-7.5h185.7c3.9 0 7.1 3.4 7.1 7.5v45zm0-140c0 4.1-3.2 7.5-7.1 7.5H211.1c-3.9 0-7.1-3.4-7.1-7.5v-45c0-4.1 3.2-7.5 7.1-7.5h185.7c3.9 0 7.1 3.4 7.1 7.5v45zm416 140c0 4.1-3.2 7.5-7.1 7.5H627.1c-3.9 0-7.1-3.4-7.1-7.5v-45c0-4.1 3.2-7.5 7.1-7.5h185.7c3.9 0 7.1 3.4 7.1 7.5v45zm0-140c0 4.1-3.2 7.5-7.1 7.5H627.1c-3.9 0-7.1-3.4-7.1-7.5v-45c0-4.1 3.2-7.5 7.1-7.5h185.7c3.9 0 7.1 3.4 7.1 7.5v45z",fill:"currentColor"},null,-1),rn=[ln];function un(e,u){return B(),L("svg",an,rn)}const cn=le(sn,[["render",un]]),dn={class:"w-full flex-shrink-0 flex flex-col justify-between"},fn={class:"flex justify-between"},On=X({__name:"RichTextEditBox",emits:["send"],setup(e,{emit:u}){let r=xe(ot);const f=ie(),p=u,i=M(""),a=M(r.createEventTemplate({})),l=M(!1),s=M(!1),t=M(null);qe(t,w=>{l.value=!1,s.value=!1});function n(w,m){a.value=r.createEventTemplate({content:w,tags:m.tags})}function c(){p("send",a.value)}const h=Xe(()=>{l.value=!1},2e3),v=()=>{var w;(w=h.clear)==null||w.call(h),l.value=!0};function b(){s.value=!1}function S(w){i.value+=w}const E=M(!1),x=Ct();async function I(w){const m=`$$${Ze()}$$`;i.value.length===0?i.value+=`${m}
`:i.value+=`
${m}
`;const T=await x(w);i.value=i.value.replace(m,T.url)}st(t,I),at(t,I);function H(){f.emitRichTextEditBox("clear")}const $=Ye("__rich_size_mode",2);function N(){$.value=(1+$.value)%3}return(w,m)=>{const T=ye,k=Se,U=ke,z=Mt,ee=we;return B(),L("div",{class:"w-full h-max box-border flex flex-col overflow-hidden flex-shrink-1",ref_key:"target",ref:t,style:ce({minHeight:y($)===0?"100%":"0%",maxHeight:E.value||y($)===0?"100%":l.value||E.value?"30em":"10em",transition:"max-height 300ms,min-height 300ms"}),onDblclick:m[5]||(m[5]=()=>s.value=!0),onMouseleave:m[6]||(m[6]=(...W)=>y(h)&&y(h)(...W))},[R("div",dn,[_(At,{show:E.value,onClick:S},null,8,["show"]),_(T,{class:"flex-shrink-0",style:{marginBottom:"0.5em",marginTop:"0.5em"}}),R("div",fn,[R("div",null,[_(U,null,{default:C(()=>[_(k,{class:"text-xl",quaternary:"",onClick:m[0]||(m[0]=()=>E.value=!E.value)},{default:C(()=>[Q(" ðŸ˜ ")]),_:1}),_(Tt,{upload:I})]),_:1})]),R("div",null,[_(k,{class:"mr-2",onClick:N},{default:C(()=>[R("div",{style:ce({transform:y($)===2?"rotateX(0turn)":"rotateX(0.5turn)",transition:"transform 0.5s ease"})},[_(z,null,{default:C(()=>[_(Zt)]),_:1})],4)]),_:1}),_(k,{class:"mr-2",onClick:H,disabled:!i.value&&!a.value.tags.length},{default:C(()=>[_(z,null,{default:C(()=>[_(Et)]),_:1})]),_:1},8,["disabled"]),_(k,{class:"mr-2",disabled:!a.value.content,onClick:m[1]||(m[1]=()=>s.value=!s.value)},{default:C(()=>[_(z,null,{default:C(()=>[s.value?(B(),j(cn,{key:0})):(B(),j(on,{key:1}))]),_:1})]),_:1},8,["disabled"]),_(k,{disabled:!a.value.content,type:"primary",onClick:c},{default:C(()=>[Q(G(w.t("send")),1)]),_:1},8,["disabled"])])])]),te(_(T,{class:"flex-shrink-0",style:{marginBottom:"0.5em",marginTop:"0.5em"}},null,512),[[ne,y($)!==2]]),R("div",{class:"flex-1 flex-shrink relative h-0",style:{},onMouseenter:v},[_(ee,{class:"flex-1 flex-shrink relative h-full",show:y($)!==2},{default:C(()=>[_(Ce,{class:Je(["h-full box-border",{"py-2":a.value.tags.length>0||y($)===0}])},{default:C(()=>[te(R("div",{class:"px-3 py-2",onClick:m[2]||(m[2]=()=>s.value=!0)},[_(lt,{event:a.value,disabledReply:""},null,8,["event"])],512),[[ne,!s.value&&a.value.content]]),te(_(Wt,{class:"transition",rawValue:i.value,"onUpdate:rawValue":m[3]||(m[3]=W=>i.value=W),onBlur:b,onFocus:m[4]||(m[4]=()=>s.value=!0),onChange:n},null,8,["rawValue"]),[[ne,s.value||!a.value.content]]),_(it,{event:a.value},null,8,["event"])]),_:1},8,["class"])]),_:1},8,["show"])],32)],36)}}});export{On as _};
