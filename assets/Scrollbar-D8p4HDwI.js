import{R as Z}from"./ReloadCircleSharp-DAOD49WP.js";import{aq as G,ar as J,v as K,as as O}from"./ProvideEventLine-XLCKst21.js";import{bv as Q,ba as W,S as X,q as n,f as j,am as E,bZ as ee,R as D,an as I,L as te,k as F,o as _,B as x,$ as L,n as h,w,A as Y,E as oe,r as H,F as re,al as ae,b_ as A,a1 as se,_ as ne}from"./index-Bp8Ru9nj.js";import{N as le}from"./Icon-BUbDyWQc.js";import{N as ie}from"./Scrollbar-DlbzZyTV.js";const[ue,fe]=G("refresh-state",()=>{const u=new Q;return W(()=>{u.removeAllListeners()}),{on(a,s){return u.on(a,s),()=>this.removeListener(a,s)},emit(a){u.emit(a)},removeListener(a,s){u.removeListener(a,s)}}});function xe(u,a){const s=X(),l=fe();["load","auto-load"].forEach(o=>{l==null||l.on(o,()=>{n(a)&&(console.log("auto-load"),f())})}),l==null||l.on("refresh",()=>{n(a)&&i()});function f(){var o;(o=u.value)==null||o.load(),s.info(t("loading"))}function i(){var o;(o=u.value)==null||o.loadNew(),s.info(t("refreshing"))}return{load:f,refresh:i}}const ce=j({__name:"Refresh",props:{refreshable:{type:Boolean},loadable:{type:Boolean},triggerDistance:{default:150},maxShifting:{default:200},containerRef:{}},emits:["refresh","load","auto-refresh","auto-load"],setup(u,{emit:a}){let s=__loggerFactory.create("/home/runner/work/jumpalong/jumpalong/apps/browser-ui/src/components/Refresh.vue");const l=u,f=a,{refreshable:i,loadable:o,containerRef:e,maxShifting:S}=E(l),{emit:d}=ue();function M(){i!=null&&i.value&&(f("refresh"),d==null||d("refresh"))}function P(){o!=null&&o.value&&(f("load"),d==null||d("load"))}const{shifting:v,moveScale:ve,add:B,remake:V}=J(S);let R=null;const{x:pe,y:$,arrivedState:c,directions:N}=ee(e);let q=A(()=>{s.debug("auto-load"),d("auto-load"),f("auto-load")},3e3),T=A(()=>{s.debug("auto-refresh"),d("auto-refresh"),f("auto-refresh")},3e3);D(()=>{var b;if(!e.value||!e.value.children[0])return;let r=(b=e.value.children[0])==null?void 0:b.getBoundingClientRect().height,p=$.value+e.value.getBoundingClientRect().height;r-p<r/2?N.bottom&&q():$.value<r/2&&N.top&&T()});const U=ae(()=>{C(),y(),m.value=!0},500);I(e,"mousewheel",r=>{(c.bottom||c.top)&&(U(),B(-r.wheelDeltaY/3),m.value=!0)},{passive:!0}),I(e,"touchmove",r=>{if(!(c.bottom||c.top))return;const p=r.touches[0].clientY;p&&(R&&B(R-p),R=p,m.value=!1)},{passive:!0}),I(e,"touchend",r=>{(c.bottom||c.top)&&(C(),y(),m.value=!0)},{passive:!0}),D(()=>{c.bottom||c.top||(y(),m.value=!0)});function C(){Math.abs(v.value)>l.triggerDistance&&(v.value>0?P():v.value<0&&M())}function y(){V(),R=null}const m=te(!1),k=K(),g=F(()=>{if(v.value<0&&c.top)return v.value;if(v.value>0){const r=k==null?void 0:k.containerRef.value;if(c.bottom||r&&r.offsetHeight===r.scrollHeight)return v.value}return 0});return(r,p)=>{const b=Z,z=le;return _(),x(re,null,[n(i)?(_(),x("div",{key:0,class:"w-full h-20 flex items-center justify-center absolute",style:L({transform:`translate(0,calc(${-n(g)}px + -100%)) rotate(${-n(g)*10}deg)`,transition:n(m)?"transform 0.5s":"",zIndex:1})},[h(z,{size:50},{default:w(()=>[h(b)]),_:1})],4)):Y("",!0),oe("div",{class:"wraps flex flex-col h-full relative overflow-hidden",style:L({transform:`translate(0,calc(${-n(g)/4}px ))`,transition:n(m)?"transform 0.3s":"",zIndex:0})},[H(r.$slots,"default")],4),n(o)?(_(),x("div",{key:1,class:"w-full h-20 flex items-center justify-center absolute bottom-0",style:L({transform:`translate(0px,calc(${-n(g)}px + 100%)) rotate(${-n(g)*10}deg)`,transition:n(m)?"transform 0.3s":"",zIndex:1})},[h(z,{size:50},{default:w(()=>[h(b)]),_:1})],4)):Y("",!0)],64)}}}),de={class:"wraps flex flex-col h-full relative overflow-hidden"},me=j({__name:"Scrollbar",props:{refreshable:{type:Boolean},loadable:{type:Boolean},triggerDistance:{},maxShifting:{}},emits:["refresh","load","auto-refresh","auto-load"],setup(u,{emit:a}){const s=F(()=>{var o;return(o=l.value)==null?void 0:o.scrollbarInstRef.containerRef}),{scrollbarInst:l}=O(s),f=u;E(f);const i=a;return(o,e)=>{const S=ie;return _(),x("div",de,[h(ce,se({"container-ref":n(s)},f,{onLoad:e[1]||(e[1]=()=>i("load")),onRefresh:e[2]||(e[2]=()=>i("refresh")),onAutoLoad:e[3]||(e[3]=()=>i("auto-load")),onAutoRefresh:e[4]||(e[4]=()=>i("auto-refresh"))}),{default:w(()=>[h(S,{class:"w-full flex-shrink flex-1",onScroll:e[0]||(e[0]=()=>{}),ref_key:"scrollbarInst",ref:l},{default:w(()=>[H(o.$slots,"default",{},void 0,!0)]),_:3},512)]),_:3},16,["container-ref"])])}}}),we=ne(me,[["__scopeId","data-v-dcbf63a6"]]);export{we as S,fe as a,xe as u};
