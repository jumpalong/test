import{R as G}from"./ReloadCircleSharp-GyWaURTC.js";import{aj as J,ak as K,w as O,al as Q}from"./ProvideEventLine-BcjESPsS.js";import{bw as W,bb as X,S as Z,q as n,f as A,ao as V,bU as ee,R as D,ap as I,L as te,k as E,o as x,B as _,_ as L,n as h,w,A as Y,E as oe,r as F,F as re,an as ae,bV as j,a0 as se,a3 as ne}from"./index-DVMYH3P6.js";import{N as le}from"./Icon-affED87R.js";import{N as ie}from"./Scrollbar-CnPFJxyc.js";const[ue,fe]=J("refresh-state",()=>{const u=new W;return X(()=>{u.removeAllListeners()}),{on(a,s){return u.on(a,s),()=>this.removeListener(a,s)},emit(a){u.emit(a)},removeListener(a,s){u.removeListener(a,s)}}});function _e(u,a){const s=Z(),l=fe();["load","auto-load"].forEach(o=>{l==null||l.on(o,()=>{n(a)&&(console.log("auto-load"),f())})}),l==null||l.on("refresh",()=>{n(a)&&i()});function f(){var o;(o=u.value)==null||o.load(),s.info(t("loading"))}function i(){var o;(o=u.value)==null||o.loadNew(),s.info(t("refreshing"))}return{load:f,refresh:i}}const ce=A({__name:"Refresh",props:{refreshable:{type:Boolean},loadable:{type:Boolean},triggerDistance:{default:150},maxShifting:{default:200},containerRef:{}},emits:["refresh","load","auto-refresh","auto-load"],setup(u,{emit:a}){let s=__loggerFactory.create("/home/runner/work/jumpalong/jumpalong/apps/browser-ui/src/components/Refresh.vue");const l=u,f=a,{refreshable:i,loadable:o,containerRef:e,maxShifting:S}=V(l),{emit:d}=ue();function H(){i!=null&&i.value&&(f("refresh"),d==null||d("refresh"))}function M(){o!=null&&o.value&&(f("load"),d==null||d("load"))}const{shifting:p,moveScale:pe,add:B,remake:P}=K(S);let R=null;const{x:ve,y:$,arrivedState:c,directions:N}=ee(e);let U=j(()=>{s.debug("auto-load"),d("auto-load"),f("auto-load")},3e3),q=j(()=>{s.debug("auto-refresh"),d("auto-refresh"),f("auto-refresh")},3e3);D(()=>{var b;if(!e.value||!e.value.children[0])return;let r=(b=e.value.children[0])==null?void 0:b.getBoundingClientRect().height,v=$.value+e.value.getBoundingClientRect().height;r-v<r/2?N.bottom&&U():$.value<r/2&&N.top&&q()});const T=ae(()=>{C(),y(),m.value=!0},500);I(e,"mousewheel",r=>{(c.bottom||c.top)&&(T(),B(-r.wheelDeltaY/3),m.value=!0)},{passive:!0}),I(e,"touchmove",r=>{if(!(c.bottom||c.top))return;const v=r.touches[0].clientY;v&&(R&&B(R-v),R=v,m.value=!1)},{passive:!0}),I(e,"touchend",r=>{(c.bottom||c.top)&&(C(),y(),m.value=!0)},{passive:!0}),D(()=>{c.bottom||c.top||(y(),m.value=!0)});function C(){Math.abs(p.value)>l.triggerDistance&&(p.value>0?M():p.value<0&&H())}function y(){P(),R=null}const m=te(!1),k=O(),g=E(()=>{if(p.value<0&&c.top)return p.value;if(p.value>0){const r=k==null?void 0:k.containerRef.value;if(c.bottom||r&&r.offsetHeight===r.scrollHeight)return p.value}return 0});return(r,v)=>{const b=G,z=le;return x(),_(re,null,[n(i)?(x(),_("div",{key:0,class:"w-full h-20 flex items-center justify-center absolute",style:L({transform:`translate(0,calc(${-n(g)}px + -100%)) rotate(${-n(g)*10}deg)`,transition:n(m)?"transform 0.5s":"",zIndex:1})},[h(z,{size:50},{default:w(()=>[h(b)]),_:1})],4)):Y("",!0),oe("div",{class:"wraps flex flex-col h-full relative overflow-hidden",style:L({transform:`translate(0,calc(${-n(g)/4}px ))`,transition:n(m)?"transform 0.3s":"",zIndex:0})},[F(r.$slots,"default")],4),n(o)?(x(),_("div",{key:1,class:"w-full h-20 flex items-center justify-center absolute bottom-0",style:L({transform:`translate(0px,calc(${-n(g)}px + 100%)) rotate(${-n(g)*10}deg)`,transition:n(m)?"transform 0.3s":"",zIndex:1})},[h(z,{size:50},{default:w(()=>[h(b)]),_:1})],4)):Y("",!0)],64)}}}),de={class:"wraps flex flex-col h-full relative overflow-hidden"},me=A({__name:"Scrollbar",props:{refreshable:{type:Boolean},loadable:{type:Boolean},triggerDistance:{},maxShifting:{}},emits:["refresh","load","auto-refresh","auto-load"],setup(u,{emit:a}){const s=E(()=>{var o;return(o=l.value)==null?void 0:o.scrollbarInstRef.containerRef}),{scrollbarInst:l}=Q(s),f=u;V(f);const i=a;return(o,e)=>{const S=ie;return x(),_("div",de,[h(ce,se({"container-ref":n(s)},f,{onLoad:e[1]||(e[1]=()=>i("load")),onRefresh:e[2]||(e[2]=()=>i("refresh")),onAutoLoad:e[3]||(e[3]=()=>i("auto-load")),onAutoRefresh:e[4]||(e[4]=()=>i("auto-refresh"))}),{default:w(()=>[h(S,{class:"w-full flex-shrink flex-1",onScroll:e[0]||(e[0]=()=>{}),ref_key:"scrollbarInst",ref:l},{default:w(()=>[F(o.$slots,"default",{},void 0,!0)]),_:3},512)]),_:3},16,["container-ref"])])}}}),we=ne(me,[["__scopeId","data-v-dcbf63a6"]]);export{we as S,fe as a,_e as u};
