import{u as T,aa as R,a4 as w,a6 as x,a9 as C,ab as F,o as N,a5 as V}from"./ProvideEventLine-BcjESPsS.js";import{P as z,c as A,d as I}from"./Papaw-Deuq0NJ6.js";import{a as E,b as U}from"./PapawList.vue_vue_type_script_setup_true_lang-DhIrlK79.js";import{a as H,S as M}from"./Scrollbar-Ci8GVXLr.js";import{f as g,k as p,L as b,X as O,S as L,bb as j,q as s,o as n,m as y,B as f,n as u,w as k,y as q,z as D,ao as G,aO as W,A as S,F as X,C as J,al as K,U as Q}from"./index-DVMYH3P6.js";import{b as Y}from"./Button-Czpa3xjC.js";import{_ as Z}from"./Empty-CBIm7nuM.js";import{_ as ee}from"./PostList.vue_vue_type_script_setup_true_lang-CXRlCGzr.js";import{_ as te}from"./RichTextEditBox.vue_vue_type_script_setup_true_lang-Cw9asIR0.js";const se={key:1},ne={key:0,class:"w-full flex justify-center items-center"},ae=g({__name:"PapawTreeParent",props:{id:{},relays:{},chindEvent:{}},setup(h){const _=h,l=T(R),v=w(x),m=p(()=>l.getEventById(_.id,{urls:_.relays})),c=p(()=>m.value.getLatestEvent()),a=b(!1),d=O();function e(){a.value=!0,d.start(),setTimeout(()=>{d.finish()},1e3)}const o=L(),r=H();if(r){const i=r.on("refresh",()=>{a.value?o.success(t("non_existent")):(i(),setTimeout(()=>{e(),o.success(t("load_parent_success"))}))});j(i)}return!v.enableLazyLoadPapawTree&&e(),(i,ue)=>{const $=Y,B=Z;return s(c)&&s(a)?(n(),y(P,{key:0,event:s(c),relays:i.relays},null,8,["event","relays"])):(n(),f("div",se,[!s(a)&&s(c)?(n(),f("div",ne,[u($,{text:"",onClick:e},{default:k(()=>[q(D(i.t("load_parent")),1)]),_:1})])):(n(),y(B,{key:1,description:i.t("not_found_post"),size:"huge"},null,8,["description"])),u(z,null,{default:k(()=>[u(E,{event:i.chindEvent},null,8,["event"])]),_:1})]))}}}),oe={key:0},re={key:1},le={key:2},P=g({__name:"PapawTreeAutoFindRoot",props:{event:{},relays:{},deleteEvent:{},withPapawOptionsButtons:{type:Boolean,default:!0}},setup(h){const _=h,{event:l}=G(_),v=p(()=>l.value.tags.filter(e=>e[0]==="e"&&e[1]&&(e[2]===void 0||e[2]==="reply"))),m=p(()=>W(new Set(_.relays),C(l.value.tags))),c=p(()=>v.value.length>0),a=p(()=>new Set(v.value.map(e=>e[1]))),d=p(()=>{var e;return(e=F(l.value.tags))==null?void 0:e[1]});return(e,o)=>s(d)?(n(),f("div",oe,[u(A,{id:s(d)},{reply:k(({event:r})=>[r?(n(),y(U,{key:0,event:r},null,8,["event"])):S("",!0)]),_:1},8,["id"])])):s(c)?(n(),f("div",re,[(n(!0),f(X,null,J(s(a),r=>(n(),y(ae,{chindEvent:s(l),relays:s(m),id:r},null,8,["chindEvent","relays","id"]))),256))])):(n(),f("div",le,[u(E,{event:s(l)},null,8,["event"])]))}}),ie={key:0,class:"flex flex-col w-full h-full overflow-auto"},ke=g({__name:"Article",props:{event:{},urls:{}},emits:["pushEvent"],setup(h,{emit:_}){const l=h,v=L(),m=K(l,"urls"),c=w(V),a=b(void 0),d=N(1,void 0,{urls:m});async function e(o){await d(o),v.info("send")}return(o,r)=>o.event?(n(),f("div",ie,[u(M,{class:"w-full h-0 flex-shrink flex-1",loadable:"",refreshable:""},{default:k(()=>[s(c).enableTree?(n(),y(P,{key:0,event:o.event},null,8,["event"])):(n(),y(I,{key:1,event:o.event},{reply:k(()=>[u(ee,{pushEvent:s(a),"onUpdate:pushEvent":r[0]||(r[0]=i=>Q(a)?a.value=i:null),urls:s(m),filter:{"#e":[o.event.id],kinds:[1,30023]},active:"",disabledReply:""},null,8,["pushEvent","urls","filter"])]),_:1},8,["event"]))]),_:1}),u(te,{onSend:e})])):S("",!0)}});export{ke as _};
